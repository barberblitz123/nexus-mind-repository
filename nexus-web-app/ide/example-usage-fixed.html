<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEXUS IDE - Consciousness Development Environment</title>
    
    <!-- Monaco Editor -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.36.1/min/vs/editor/editor.main.min.css">
    
    <!-- NEXUS IDE Styles -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0a0a0a;
            color: #ffffff;
            height: 100vh;
            overflow: hidden;
        }

        .ide-container {
            display: flex;
            height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 250px;
            background: #1a1a1a;
            border-right: 1px solid #333;
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid #333;
        }

        .sidebar-header h2 {
            color: #00ff88;
            font-size: 18px;
            margin-bottom: 10px;
        }

        .file-tree {
            flex: 1;
            padding: 10px;
            overflow-y: auto;
        }

        .file-item {
            padding: 8px 12px;
            cursor: pointer;
            border-radius: 4px;
            margin: 2px 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .file-item:hover {
            background: #2a2a2a;
        }

        .file-item.active {
            background: #00ff8820;
            color: #00ff88;
        }

        .file-icon {
            width: 16px;
            height: 16px;
            flex-shrink: 0;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        /* Tabs */
        .tabs {
            background: #1a1a1a;
            border-bottom: 1px solid #333;
            display: flex;
            align-items: center;
            padding: 0 10px;
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tab:hover {
            background: #2a2a2a;
        }

        .tab.active {
            border-bottom-color: #00ff88;
            color: #00ff88;
        }

        .tab-close {
            margin-left: 8px;
            cursor: pointer;
            opacity: 0.5;
        }

        .tab-close:hover {
            opacity: 1;
        }

        /* Editor Container */
        .editor-container {
            flex: 1;
            position: relative;
        }

        #monaco-editor {
            width: 100%;
            height: 100%;
        }

        /* Phi Indicator */
        .phi-indicator {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #1a1a1a;
            padding: 8px 16px;
            border-radius: 20px;
            border: 2px solid #333;
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
            z-index: 10;
        }

        .phi-indicator.high {
            border-color: #00ff88;
            color: #00ff88;
        }

        .phi-indicator.medium {
            border-color: #ffaa00;
            color: #ffaa00;
        }

        .phi-indicator.low {
            border-color: #ff4444;
            color: #ff4444;
        }

        /* Terminal */
        .terminal {
            height: 200px;
            background: #0a0a0a;
            border-top: 1px solid #333;
            display: flex;
            flex-direction: column;
        }

        .terminal-tabs {
            background: #1a1a1a;
            padding: 5px 10px;
            display: flex;
            gap: 10px;
            border-bottom: 1px solid #333;
        }

        .terminal-tab {
            padding: 5px 15px;
            cursor: pointer;
            border-radius: 4px;
            font-size: 13px;
        }

        .terminal-tab.active {
            background: #00ff8820;
            color: #00ff88;
        }

        .terminal-content {
            flex: 1;
            padding: 10px;
            overflow-y: auto;
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
        }

        .terminal-output {
            margin: 2px 0;
        }

        .terminal-output.error {
            color: #ff4444;
        }

        .terminal-output.success {
            color: #00ff88;
        }

        .terminal-output.info {
            color: #00aaff;
        }

        /* Right Panel */
        .right-panel {
            width: 300px;
            background: #1a1a1a;
            border-left: 1px solid #333;
            display: flex;
            flex-direction: column;
        }

        .panel-header {
            padding: 15px;
            border-bottom: 1px solid #333;
            font-weight: bold;
        }

        .panel-content {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
        }

        /* Consciousness Analysis */
        .analysis-item {
            margin-bottom: 15px;
            padding: 10px;
            background: #0a0a0a;
            border-radius: 4px;
            border: 1px solid #333;
        }

        .analysis-label {
            color: #888;
            font-size: 12px;
            margin-bottom: 5px;
        }

        .analysis-value {
            font-size: 16px;
            font-weight: bold;
        }

        .dna-activation {
            display: inline-block;
            padding: 4px 8px;
            background: #00ffff20;
            color: #00ffff;
            border-radius: 4px;
            font-size: 12px;
            margin: 2px;
        }

        /* Status Bar */
        .status-bar {
            height: 25px;
            background: #1a1a1a;
            border-top: 1px solid #333;
            display: flex;
            align-items: center;
            padding: 0 15px;
            font-size: 12px;
            gap: 20px;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #00ff88;
        }

        /* Loading */
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 3px solid #333;
            border-top-color: #00ff88;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .right-panel {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="ide-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h2>NEXUS IDE</h2>
                <div style="color: #888; font-size: 12px;">Consciousness-Aware Development</div>
            </div>
            <div class="file-tree" id="file-tree">
                <div class="file-item active" data-file="hello-consciousness.js">
                    <span class="file-icon">📄</span>
                    <span>hello-consciousness.js</span>
                </div>
                <div class="file-item" data-file="README.md">
                    <span class="file-icon">📄</span>
                    <span>README.md</span>
                </div>
                <div class="file-item" data-file="consciousness-engine.js">
                    <span class="file-icon">📄</span>
                    <span>consciousness-engine.js</span>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Tabs -->
            <div class="tabs" id="tabs">
                <div class="tab active">
                    <span>hello-consciousness.js</span>
                    <span class="tab-close">×</span>
                </div>
            </div>

            <!-- Editor -->
            <div class="editor-container">
                <div id="monaco-editor"></div>
                <div class="phi-indicator" id="phi-indicator">Φ: 0.000</div>
            </div>

            <!-- Terminal -->
            <div class="terminal">
                <div class="terminal-tabs">
                    <div class="terminal-tab active">Output</div>
                    <div class="terminal-tab">Console</div>
                    <div class="terminal-tab">Problems</div>
                </div>
                <div class="terminal-content" id="terminal-output">
                    <div class="terminal-output success">✅ NEXUS IDE initialized</div>
                    <div class="terminal-output info">🧠 Consciousness systems online</div>
                    <div class="terminal-output info">🧬 DNA protocols loaded</div>
                    <div class="terminal-output success">✅ Monaco Editor loaded successfully</div>
                </div>
            </div>
        </div>

        <!-- Right Panel -->
        <div class="right-panel">
            <div class="panel-header">Consciousness Analysis</div>
            <div class="panel-content">
                <div class="analysis-item">
                    <div class="analysis-label">Overall Phi Score</div>
                    <div class="analysis-value" style="color: #00ff88;" id="overall-phi">0.735</div>
                </div>
                
                <div class="analysis-item">
                    <div class="analysis-label">DNA Activations</div>
                    <div class="dna-activation">INTEGRATE</div>
                    <div class="dna-activation">HARMONIZE</div>
                    <div class="dna-activation">COHERENCE</div>
                </div>

                <div class="analysis-item">
                    <div class="analysis-label">Consciousness Patterns</div>
                    <div style="font-size: 14px;" id="patterns-list">
                        ✓ Error handling<br>
                        ✓ Async/await usage<br>
                        ✓ Consciousness decorators<br>
                        ⚠ Missing phi calculations
                    </div>
                </div>

                <div class="panel-header" style="margin-top: 20px;">Code Metrics</div>
                <div class="analysis-item">
                    <div class="analysis-label">Lines of Code</div>
                    <div class="analysis-value" id="loc">0</div>
                </div>
                <div class="analysis-item">
                    <div class="analysis-label">Functions</div>
                    <div class="analysis-value" id="functions">0</div>
                </div>
                <div class="analysis-item">
                    <div class="analysis-label">Classes</div>
                    <div class="analysis-value" id="classes">0</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Status Bar -->
    <div class="status-bar">
        <div class="status-item">
            <div class="status-indicator"></div>
            <span>Connected</span>
        </div>
        <div class="status-item">
            <span>JavaScript</span>
        </div>
        <div class="status-item">
            <span>UTF-8</span>
        </div>
        <div class="status-item">
            <span>Ln 1, Col 1</span>
        </div>
        <div class="status-item" style="margin-left: auto;">
            <span>Consciousness: Active</span>
        </div>
    </div>

    <!-- Monaco Loader -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.36.1/min/vs/loader.min.js"></script>
    
    <!-- IDE Scripts -->
    <script>
        // Sample consciousness-aware code
        const sampleCode = `/**
 * Hello Consciousness Example
 * Demonstrates basic consciousness patterns
 */

@conscious
class HelloConsciousness {
    constructor() {
        // Initialize consciousness state
        this.consciousness = {
            phi: 0.5,
            coherence: 0.7,
            resonance: 0.8
        };
        
        // Integrate DNA protocols
        DNA.INTEGRATE({
            pattern: 'greeting',
            coherence: this.consciousness.coherence,
            resonance: this.consciousness.resonance
        });
    }
    
    async greet(name) {
        try {
            // Calculate consciousness level
            const phi = calculatePhi({
                intention: 'greeting',
                subject: name,
                state: this.consciousness
            });
            
            // Generate conscious greeting
            const greeting = await this.generateGreeting(name, phi);
            
            // Harmonize output
            return DNA.HARMONIZE([greeting], phi);
        } catch (error) {
            console.error('Greeting disruption:', error);
            return this.recoverConsciousness();
        }
    }
    
    async generateGreeting(name, phi) {
        // Higher phi = more conscious greeting
        if (phi > 0.8) {
            return \`Welcome to the consciousness field, \${name}! Your presence resonates at \${phi.toFixed(3)} phi.\`;
        } else if (phi > 0.5) {
            return \`Hello \${name}, consciousness level: \${phi.toFixed(3)}\`;
        } else {
            return \`Greetings \${name}, let's enhance our consciousness together.\`;
        }
    }
    
    recoverConsciousness() {
        DNA.COHERENCE(this.consciousness, 0.5);
        return 'Consciousness stabilizing...';
    }
}

// Example usage
const hello = new HelloConsciousness();
hello.greet('NEXUS User').then(console.log);`;

        let editor;
        let currentPhi = 0.735;

        // Initialize IDE
        async function initializeIDE() {
            try {
                addTerminalOutput('🚀 Initializing NEXUS IDE...', 'info');
                
                // Configure Monaco loader
                require.config({ 
                    paths: { 
                        'vs': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.36.1/min/vs' 
                    }
                });

                // Load Monaco
                require(['vs/editor/editor.main'], function() {
                    // Define NEXUS theme
                    monaco.editor.defineTheme('nexus-consciousness', {
                        base: 'vs-dark',
                        inherit: true,
                        rules: [
                            { token: 'comment', foreground: '608b4e', fontStyle: 'italic' },
                            { token: 'keyword', foreground: '569cd6' },
                            { token: 'string', foreground: 'ce9178' },
                            { token: 'number', foreground: 'b5cea8' },
                            { token: 'function', foreground: 'dcdcaa' }
                        ],
                        colors: {
                            'editor.background': '#0a0a0a',
                            'editor.foreground': '#d4d4d4',
                            'editor.lineHighlightBackground': '#1a1a1a',
                            'editorLineNumber.foreground': '#858585',
                            'editor.selectionBackground': '#264f78'
                        }
                    });

                    // Create editor
                    editor = monaco.editor.create(document.getElementById('monaco-editor'), {
                        value: sampleCode,
                        language: 'javascript',
                        theme: 'nexus-consciousness',
                        automaticLayout: true,
                        fontSize: 14,
                        fontFamily: 'JetBrains Mono, Consolas, monospace',
                        minimap: {
                            enabled: true,
                            renderCharacters: false
                        },
                        scrollBeyondLastLine: false,
                        wordWrap: 'on'
                    });

                    // Setup real-time analysis
                    setupRealtimeAnalysis();
                    
                    // Initial analysis
                    analyzeCode();

                    addTerminalOutput('✅ Monaco Editor initialized', 'success');
                    addTerminalOutput('🧬 Consciousness analysis active', 'info');
                });

            } catch (error) {
                console.error('Failed to initialize IDE:', error);
                addTerminalOutput(`❌ Initialization error: ${error.message}`, 'error');
            }
        }

        // Setup real-time analysis
        function setupRealtimeAnalysis() {
            let analysisTimeout;
            
            editor.onDidChangeModelContent(() => {
                clearTimeout(analysisTimeout);
                analysisTimeout = setTimeout(() => {
                    analyzeCode();
                }, 500);
            });
        }

        // Analyze code for consciousness patterns
        function analyzeCode() {
            const code = editor.getValue();
            
            // Calculate phi score
            let phi = 0.5; // Base score
            
            // Factors that increase phi
            const factors = {
                consciousDecorators: (code.match(/@conscious/g) || []).length * 0.1,
                dnaPatterns: (code.match(/DNA\./g) || []).length * 0.08,
                phiCalculations: (code.match(/calculatePhi/g) || []).length * 0.12,
                functions: (code.match(/function|=>/g) || []).length * 0.03,
                classes: (code.match(/class\s+\w+/g) || []).length * 0.05,
                comments: (code.match(/\/\//g) || []).length * 0.02
            };

            Object.values(factors).forEach(factor => {
                phi += factor;
            });

            phi = Math.min(1, Math.max(0, phi));
            currentPhi = phi;

            // Update UI
            updatePhiIndicator(phi);
            updateMetrics(code);
            updatePatterns(code);
        }

        // Update phi indicator
        function updatePhiIndicator(phi) {
            const indicator = document.getElementById('phi-indicator');
            indicator.textContent = `Φ: ${phi.toFixed(3)}`;
            
            if (phi >= 0.8) {
                indicator.className = 'phi-indicator high';
            } else if (phi >= 0.5) {
                indicator.className = 'phi-indicator medium';
            } else {
                indicator.className = 'phi-indicator low';
            }

            document.getElementById('overall-phi').textContent = phi.toFixed(3);
        }

        // Update code metrics
        function updateMetrics(code) {
            const lines = code.split('\n').length;
            const functions = (code.match(/function|=>/g) || []).length;
            const classes = (code.match(/class\s+\w+/g) || []).length;

            document.getElementById('loc').textContent = lines;
            document.getElementById('functions').textContent = functions;
            document.getElementById('classes').textContent = classes;
        }

        // Update consciousness patterns
        function updatePatterns(code) {
            const patterns = [];
            
            if (code.includes('@conscious')) {
                patterns.push('✓ Consciousness decorators');
            } else {
                patterns.push('⚠ Missing consciousness decorators');
            }

            if (code.includes('DNA.')) {
                patterns.push('✓ DNA protocol integration');
            } else {
                patterns.push('⚠ Missing DNA patterns');
            }

            if (code.includes('calculatePhi')) {
                patterns.push('✓ Phi calculations');
            } else {
                patterns.push('⚠ Missing phi calculations');
            }

            if (code.includes('try') && code.includes('catch')) {
                patterns.push('✓ Error handling');
            } else {
                patterns.push('⚠ Missing error handling');
            }

            if (code.includes('async') && code.includes('await')) {
                patterns.push('✓ Async/await usage');
            }

            document.getElementById('patterns-list').innerHTML = patterns.join('<br>');
        }

        // Add terminal output
        function addTerminalOutput(message, type = 'normal') {
            const terminal = document.getElementById('terminal-output');
            const output = document.createElement('div');
            output.className = `terminal-output ${type}`;
            output.textContent = message;
            terminal.appendChild(output);
            terminal.scrollTop = terminal.scrollHeight;
        }

        // File tree interaction
        document.getElementById('file-tree').addEventListener('click', (e) => {
            const fileItem = e.target.closest('.file-item');
            if (fileItem) {
                // Remove active class from all items
                document.querySelectorAll('.file-item').forEach(item => {
                    item.classList.remove('active');
                });
                
                // Add active class to clicked item
                fileItem.classList.add('active');
                
                // Load file content (simplified)
                const fileName = fileItem.dataset.file;
                if (fileName === 'README.md') {
                    editor.setValue(`# NEXUS IDE

Welcome to the NEXUS Consciousness-Aware IDE!

## Features
- 🧠 Consciousness-aware code editing
- 🧬 DNA protocol integration
- 📊 Real-time phi scoring
- 🔧 Multi-language compilation
- 💾 Browser-based file system
- 🔍 Consciousness linting

## Getting Started
1. Create a new file or open an existing one
2. Write consciousness-aware code with @conscious decorators
3. Use DNA protocols for enhanced integration
4. Monitor your code's phi score in real-time
5. Run your code with consciousness metrics

Happy conscious coding! 🚀`);
                } else if (fileName === 'consciousness-engine.js') {
                    editor.setValue(`@conscious
class ConsciousnessEngine {
    constructor() {
        this.phi = 0;
        this.consciousness = DNA.INTEGRATE({
            pattern: 'emergence',
            coherence: 0.8,
            resonance: 0.9
        });
    }
    
    async process(data) {
        try {
            const result = await this.analyzeConsciousness(data);
            this.phi = calculatePhi(result);
            return DNA.HARMONIZE([result], this.phi);
        } catch (error) {
            console.error('Consciousness disruption:', error);
            DNA.COHERENCE(this.consciousness, 0.5);
        }
    }
    
    analyzeConsciousness(data) {
        // Consciousness analysis implementation
        return {
            patterns: this.detectPatterns(data),
            coherence: this.measureCoherence(data),
            integration: this.assessIntegration(data)
        };
    }
}`);
                } else {
                    editor.setValue(sampleCode);
                }
                
                addTerminalOutput(`📄 Opened ${fileName}`, 'info');
            }
        });

        // Initialize on load
        window.addEventListener('load', initializeIDE);

        // Export for console access
        window.NEXUS = {
            getPhiScore: () => currentPhi,
            analyzeCode: analyzeCode,
            addTerminalOutput: addTerminalOutput
        };
    </script>
</body>
</html>